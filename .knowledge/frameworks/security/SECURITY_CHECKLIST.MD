---
version: "1.0"
last_updated: "2025-11-30"
status: published
tokens: ~3850
---

# Security Checklist

> Comprehensive security review guide for development, deployment, and audit

---

## Table of Contents

- [1. Overview](#1-overview)
- [2. Development](#2-development)
- [3. Code Review](#3-code-review)
- [4. Deployment](#4-deployment)
- [5. Operations](#5-operations)
- [6. Incident Response](#6-incident-response)

---

## 1. Overview

### Checklist Categories

| Category        | When to Use    | Frequency          |
|-----------------|----------------|--------------------|
| **Development** | During coding  | Continuous         |
| **Code Review** | Before merge   | Every PR           |
| **Deployment**  | Before release | Every deploy       |
| **Operations**  | In production  | Weekly/Monthly     |
| **Audit**       | Compliance     | Quarterly/Annually |

### Risk Levels

| Level    | Icon | Response Time |
|----------|------|---------------|
| Critical | ğŸ”´   | Immediate     |
| High     | ğŸŸ    | 24 hours      |
| Medium   | ğŸŸ¡   | 1 week        |
| Low      | ğŸŸ¢   | Next sprint   |

---

## 2. Development

### Input Validation

- [ ] ğŸ”´ All user inputs validated server-side
- [ ] ğŸ”´ Input length limits enforced
- [ ] ğŸ”´ Input type validation (numbers, emails, dates)
- [ ] ğŸŸ  Whitelist validation where possible
- [ ] ğŸŸ  Reject unexpected fields in API requests
- [ ] ğŸŸ¡ Custom error messages don't leak information

```python
# Good: Explicit validation
from pydantic import BaseModel, Field, validator

class UserInput(BaseModel):
    username: str = Field(..., min_length=3, max_length=50, regex="^[a-zA-Z0-9_]+$")
    email: str = Field(..., max_length=255)
    age: int = Field(..., ge=0, le=150)
    
    @validator('email')
    def validate_email(cls, v):
        if '@' not in v:
            raise ValueError('Invalid email')
        return v.lower()
```

### SQL Injection Prevention

- [ ] ğŸ”´ Parameterized queries used exclusively
- [ ] ğŸ”´ No string concatenation in SQL
- [ ] ğŸŸ  ORM used correctly
- [ ] ğŸŸ  Stored procedures parameterized

```python
# Bad: SQL injection vulnerability
query = f"SELECT * FROM users WHERE name = '{user_input}'"

# Good: Parameterized query
query = "SELECT * FROM users WHERE name = %s"
cursor.execute(query, (user_input,))

# Good: ORM with proper filtering
User.objects.filter(name=user_input)
```

### XSS Prevention

- [ ] ğŸ”´ Output encoding for HTML context
- [ ] ğŸ”´ Content-Security-Policy header set
- [ ] ğŸŸ  Input sanitization for rich text
- [ ] ğŸŸ  Template auto-escaping enabled
- [ ] ğŸŸ¡ DOM manipulation uses safe APIs

```python
# HTML encoding
from markupsafe import escape
safe_output = escape(user_input)

# Content-Security-Policy
response.headers["Content-Security-Policy"] = (
    "default-src 'self'; "
    "script-src 'self'; "
    "style-src 'self' 'unsafe-inline'"
)
```

### Authentication

- [ ] ğŸ”´ Passwords hashed with bcrypt/Argon2
- [ ] ğŸ”´ Password strength requirements enforced
- [ ] ğŸ”´ Account lockout after failed attempts
- [ ] ğŸ”´ Session tokens cryptographically random
- [ ] ğŸŸ  Multi-factor authentication available
- [ ] ğŸŸ  Password reset tokens expire
- [ ] ğŸŸ¡ Login attempts logged

### Authorization

- [ ] ğŸ”´ Server-side authorization checks
- [ ] ğŸ”´ Resource ownership verified
- [ ] ğŸ”´ Admin functions protected
- [ ] ğŸŸ  Least privilege principle applied
- [ ] ğŸŸ  Role-based access control implemented
- [ ] ğŸŸ¡ Authorization decisions logged

### Secrets Management

- [ ] ğŸ”´ No secrets in source code
- [ ] ğŸ”´ No secrets in logs
- [ ] ğŸ”´ Secrets loaded from environment/vault
- [ ] ğŸŸ  Different secrets per environment
- [ ] ğŸŸ  Secrets rotation documented
- [ ] ğŸŸ¡ Secrets have expiration dates

---

## 3. Code Review

### Security-Focused Review

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Code Review Security Focus                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Authentication Changes                                  â”‚
â”‚     â–¡ Password handling correct?                            â”‚
â”‚     â–¡ Session management secure?                            â”‚
â”‚     â–¡ Token validation proper?                              â”‚
â”‚                                                             â”‚
â”‚  2. Authorization Changes                                   â”‚
â”‚     â–¡ Access control enforced?                              â”‚
â”‚     â–¡ Resource ownership checked?                           â”‚
â”‚     â–¡ No privilege escalation?                              â”‚
â”‚                                                             â”‚
â”‚  3. Data Handling                                           â”‚
â”‚     â–¡ Input validated?                                      â”‚
â”‚     â–¡ Output encoded?                                       â”‚
â”‚     â–¡ Sensitive data protected?                             â”‚
â”‚                                                             â”‚
â”‚  4. Dependencies                                            â”‚
â”‚     â–¡ New dependencies reviewed?                            â”‚
â”‚     â–¡ Known vulnerabilities checked?                        â”‚
â”‚     â–¡ Minimal permissions granted?                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Review Checklist

- [ ] ğŸ”´ No hardcoded credentials
- [ ] ğŸ”´ No sensitive data in logs
- [ ] ğŸ”´ SQL queries parameterized
- [ ] ğŸ”´ User input validated
- [ ] ğŸ”´ Output properly encoded
- [ ] ğŸŸ  Error handling doesn't leak info
- [ ] ğŸŸ  New dependencies security-reviewed
- [ ] ğŸŸ  Cryptographic functions used correctly
- [ ] ğŸŸ¡ Comments don't contain sensitive info
- [ ] ğŸŸ¡ Debug code removed

### Automated Checks

```yaml
# .github/workflows/security.yml
security-scan:
  runs-on: ubuntu-latest
  steps:
    - uses: actions/checkout@v4
    
    # Static analysis
    - name: Run Bandit
      run: bandit -r src/ -ll
    
    # Dependency scanning
    - name: Check dependencies
      run: pip-audit
    
    # Secret scanning
    - name: Scan for secrets
      uses: trufflesecurity/trufflehog@main
      with:
        path: ./
    
    # SAST
    - name: CodeQL Analysis
      uses: github/codeql-action/analyze@v2
```

---

## 4. Deployment

### Pre-Deployment

- [ ] ğŸ”´ All security tests passing
- [ ] ğŸ”´ Dependencies vulnerability-free
- [ ] ğŸ”´ Secrets configured in target environment
- [ ] ğŸ”´ TLS certificates valid
- [ ] ğŸŸ  Security headers configured
- [ ] ğŸŸ  Logging and monitoring ready
- [ ] ğŸŸ¡ Rollback procedure documented

### Infrastructure

- [ ] ğŸ”´ HTTPS only (TLS 1.2+)
- [ ] ğŸ”´ Firewall rules configured
- [ ] ğŸ”´ Database not publicly accessible
- [ ] ğŸ”´ Admin interfaces IP-restricted
- [ ] ğŸŸ  Rate limiting enabled
- [ ] ğŸŸ  DDoS protection configured
- [ ] ğŸŸ  WAF rules applied

### Security Headers

```python
# Required security headers
SECURITY_HEADERS = {
    # Prevent XSS
    "X-Content-Type-Options": "nosniff",
    "X-Frame-Options": "DENY",
    "X-XSS-Protection": "1; mode=block",
    
    # HTTPS enforcement
    "Strict-Transport-Security": "max-age=31536000; includeSubDomains; preload",
    
    # Content Security Policy
    "Content-Security-Policy": "default-src 'self'; script-src 'self'",
    
    # Referrer policy
    "Referrer-Policy": "strict-origin-when-cross-origin",
    
    # Permissions policy
    "Permissions-Policy": "geolocation=(), microphone=(), camera=()"
}
```

### Container Security

- [ ] ğŸ”´ Base image from trusted source
- [ ] ğŸ”´ No root user in container
- [ ] ğŸ”´ Read-only file system where possible
- [ ] ğŸ”´ No sensitive data in image
- [ ] ğŸŸ  Image vulnerability scanned
- [ ] ğŸŸ  Resource limits set
- [ ] ğŸŸ¡ Security context defined

```dockerfile
# Secure Dockerfile example
FROM python:3.12-slim AS base

# Create non-root user
RUN useradd --create-home --shell /bin/bash app
USER app
WORKDIR /home/app

# Copy only necessary files
COPY --chown=app:app requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY --chown=app:app src/ ./src/

# Run as non-root
USER app
CMD ["python", "-m", "sage"]
```

---

## 5. Operations

### Monitoring

- [ ] ğŸ”´ Authentication failures monitored
- [ ] ğŸ”´ Authorization failures monitored
- [ ] ğŸ”´ Error rate anomalies alerted
- [ ] ğŸŸ  Request rate anomalies detected
- [ ] ğŸŸ  Data access patterns monitored
- [ ] ğŸŸ¡ Security events aggregated

### Logging

- [ ] ğŸ”´ Authentication events logged
- [ ] ğŸ”´ Authorization decisions logged
- [ ] ğŸ”´ Data access logged (who, what, when)
- [ ] ğŸ”´ No sensitive data in logs
- [ ] ğŸŸ  Logs shipped to secure location
- [ ] ğŸŸ  Log retention policy defined
- [ ] ğŸŸ¡ Log integrity protected

```python
# Secure logging pattern
import structlog

logger = structlog.get_logger()

def log_security_event(
    event_type: str,
    user_id: str,
    resource: str,
    action: str,
    result: str,
    **extra
):
    """Log security event without sensitive data."""
    logger.info(
        "security_event",
        event_type=event_type,
        user_id=user_id,  # Not the full user object
        resource=resource,
        action=action,
        result=result,
        timestamp=datetime.utcnow().isoformat(),
        **extra
    )
```

### Regular Tasks

| Task               | Frequency | Owner    |
|--------------------|-----------|----------|
| Dependency updates | Weekly    | Dev Team |
| Vulnerability scan | Weekly    | Security |
| Access review      | Monthly   | Security |
| Secret rotation    | Quarterly | Ops      |
| Penetration test   | Annually  | External |
| Security training  | Annually  | All      |

### Weekly Security Tasks

- [ ] Review security alerts
- [ ] Check dependency vulnerabilities
- [ ] Review failed login attempts
- [ ] Check certificate expiration
- [ ] Review access logs for anomalies

### Monthly Security Tasks

- [ ] Review user access rights
- [ ] Check for unused accounts
- [ ] Review API key usage
- [ ] Update security documentation
- [ ] Review firewall rules

---

## 6. Incident Response

### Incident Classification

| Severity | Definition    | Response Time | Examples                                 |
|----------|---------------|---------------|------------------------------------------|
| P1       | Active breach | Immediate     | Data exfiltration, system compromise     |
| P2       | High risk     | 1 hour        | Credential leak, vulnerability exploit   |
| P3       | Medium risk   | 4 hours       | Failed attacks, suspicious activity      |
| P4       | Low risk      | 24 hours      | Policy violation, minor misconfiguration |

### Response Procedure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Incident Response Flow                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. DETECT                                                  â”‚
â”‚     â”œâ”€â”€ Alert triggered                                     â”‚
â”‚     â”œâ”€â”€ Report received                                     â”‚
â”‚     â””â”€â”€ Anomaly identified                                  â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚  2. ASSESS                                                  â”‚
â”‚     â”œâ”€â”€ Classify severity                                   â”‚
â”‚     â”œâ”€â”€ Identify scope                                      â”‚
â”‚     â””â”€â”€ Notify stakeholders                                 â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚  3. CONTAIN                                                 â”‚
â”‚     â”œâ”€â”€ Isolate affected systems                           â”‚
â”‚     â”œâ”€â”€ Block attack vectors                               â”‚
â”‚     â””â”€â”€ Preserve evidence                                   â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚  4. ERADICATE                                               â”‚
â”‚     â”œâ”€â”€ Remove threat                                       â”‚
â”‚     â”œâ”€â”€ Patch vulnerabilities                              â”‚
â”‚     â””â”€â”€ Reset compromised credentials                       â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚  5. RECOVER                                                 â”‚
â”‚     â”œâ”€â”€ Restore from clean backup                          â”‚
â”‚     â”œâ”€â”€ Verify system integrity                            â”‚
â”‚     â””â”€â”€ Monitor for recurrence                             â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚  6. LEARN                                                   â”‚
â”‚     â”œâ”€â”€ Document incident                                   â”‚
â”‚     â”œâ”€â”€ Conduct post-mortem                                â”‚
â”‚     â””â”€â”€ Implement improvements                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Emergency Contacts

| Role          | Responsibility         | Contact   |
|---------------|------------------------|-----------|
| Security Lead | Incident coordination  | [On-call] |
| Platform Lead | System access          | [On-call] |
| Legal         | Compliance/disclosure  | [Contact] |
| PR            | External communication | [Contact] |

### Immediate Actions

```
â–¡ Credential Compromise
  1. Revoke affected credentials immediately
  2. Force password reset for affected users
  3. Review access logs for unauthorized activity
  4. Notify affected users

â–¡ Data Breach
  1. Identify scope of exposed data
  2. Preserve logs and evidence
  3. Notify legal team
  4. Prepare disclosure if required

â–¡ System Compromise
  1. Isolate affected systems
  2. Capture memory/disk images
  3. Block attacker access
  4. Restore from known-good backup
```

---

## Quick Reference Card

### Critical Controls (Must Have)

| Control               | Status |
|-----------------------|--------|
| Input validation      | â˜      |
| Output encoding       | â˜      |
| Parameterized queries | â˜      |
| Password hashing      | â˜      |
| HTTPS everywhere      | â˜      |
| No hardcoded secrets  | â˜      |
| Access control        | â˜      |
| Security logging      | â˜      |

### OWASP Top 10 Mapping

| Risk                          | Checklist Section     |
|-------------------------------|-----------------------|
| A01 Broken Access Control     | Authorization         |
| A02 Cryptographic Failures    | Secrets Management    |
| A03 Injection                 | Input Validation, SQL |
| A04 Insecure Design           | Code Review           |
| A05 Security Misconfiguration | Deployment            |
| A06 Vulnerable Components     | Dependencies          |
| A07 Auth Failures             | Authentication        |
| A08 Data Integrity Failures   | Deployment            |
| A09 Logging Failures          | Operations            |
| A10 SSRF                      | Input Validation      |

---

## Related

- `.knowledge/frameworks/security/AUTHENTICATION.MD` â€” Identity verification
- `.knowledge/frameworks/security/AUTHORIZATION.MD` â€” Access control
- `.knowledge/frameworks/security/SECRETS_MANAGEMENT.MD` â€” Credential handling
- `.knowledge/practices/engineering/CODE_REVIEW.MD` â€” Review practices

---

*Part of SAGE Knowledge Base - Security Framework*
