# SAGE MCP Configuration
#
# Configuration for MCP (Model Context Protocol) service.
# This file is part of the modular configuration system.

# =============================================================================
# MCP Service Configuration
# =============================================================================
mcp:
  # Server configuration
  server:
    host: "localhost"                  # Server host
    port: 8000                         # Server port
    name: "sage-kb"                    # Server name
    version: "0.1.0"                   # Server version

  # Tool configuration
  tools:
    timeout_ms: 10000                  # Default tool timeout
    include_metadata: false            # Include metadata in responses

  # Capabilities configuration
  capabilities:
    analyzers: true                    # Enable analyzer tools
    checkers: true                     # Enable checker tools
    monitors: true                     # Enable monitor tools

  # ===========================================================================
  # Connection Management
  # ===========================================================================
  connection:
    max_concurrent: 10                 # Maximum concurrent connections
    keepalive_seconds: 300             # Connection keep-alive time (5 min)
    idle_timeout_seconds: 60           # Close idle connections after 60s
    reconnect:
      enabled: true                    # Enable auto-reconnect
      max_attempts: 5                  # Maximum reconnection attempts
      initial_delay_ms: 1000           # Initial reconnect delay
      max_delay_ms: 30000              # Maximum reconnect delay
      backoff_multiplier: 2.0          # Exponential backoff multiplier

  # ===========================================================================
  # Resource Limits
  # ===========================================================================
  resources:
    max_memory_mb: 512                 # Maximum memory usage
    max_cpu_percent: 80                # Maximum CPU utilization
    max_request_size_bytes: 10485760   # 10MB max request size
    max_response_size_bytes: 52428800  # 50MB max response size

    # Request queue limits
    queue:
      max_size: 100                    # Maximum queued requests
      timeout_ms: 30000                # Queue timeout

  # ===========================================================================
  # Feature Flags
  # ===========================================================================
  features:
    streaming: true                    # Enable streaming responses
    batch_requests: true               # Enable batch request processing
    progress_reporting: true           # Enable progress reporting
    cancellation: true                 # Enable request cancellation
    compression: false                 # Enable response compression

  # ===========================================================================
  # Rate Limiting
  # ===========================================================================
  rate_limit:
    enabled: false                     # Enable rate limiting
    requests_per_minute: 60            # Max requests per minute
    burst_size: 10                     # Burst allowance
    per_tool_limits:                   # Per-tool rate limits
      analyze_code:
        requests_per_minute: 20
      search_knowledge:
        requests_per_minute: 30

  # ===========================================================================
  # Protocol Configuration
  # ===========================================================================
  protocol:
    version: "0.1.0"                   # MCP protocol version
    strict_mode: false                 # Strict protocol validation
    allow_unknown_methods: false       # Reject unknown methods

  # ===========================================================================
  # Logging Configuration
  # ===========================================================================
  logging:
    log_requests: true                 # Log incoming requests
    log_responses: false               # Log outgoing responses (verbose)
    log_errors: true                   # Log errors
    include_payloads: false            # Include request/response payloads
    max_payload_log_size: 1024         # Max payload size to log (bytes)

  # ===========================================================================
  # Health Check
  # ===========================================================================
  health:
    enabled: true
    endpoint: /_health                 # Health check endpoint
    include_details: true              # Include service details
    check_interval_seconds: 30         # Internal health check interval
